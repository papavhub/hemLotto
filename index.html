<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lotto Generator</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a" />
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif}

body{
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:radial-gradient(circle at 20% 20%, #1e293b, #0f172a 70%);
  color:white;
  padding:20px;
}

.container{
  text-align:center;
  max-width:420px;
  width:100%;
}

h1{margin-bottom:20px}

.mode-toggle{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
  margin-bottom:20px;
  font-size:14px;
}

.switch{
  position:relative;
  width:50px;
  height:26px;
}

.switch input{display:none}

.slider{
  position:absolute;
  cursor:pointer;
  background:#64748b;
  border-radius:34px;
  width:100%;
  height:100%;
  transition:.3s;
}

.slider:before{
  content:"";
  position:absolute;
  height:20px;
  width:20px;
  left:3px;
  top:3px;
  background:white;
  border-radius:50%;
  transition:.3s;
}

input:checked + .slider{
  background:#6366f1;
}

input:checked + .slider:before{
  transform:translateX(24px);
}

.numbers{
  display:flex;
  justify-content:center;
  flex-wrap:wrap;
  gap:12px;
  margin-bottom:25px;
  min-height:60px;
}

.ball{
  width:60px;
  height:60px;
  border-radius:50%;
  display:flex;
  justify-content:center;
  align-items:center;
  font-weight:bold;
  font-size:18px;
  box-shadow:0 6px 18px rgba(0,0,0,0.4);
  transition:transform 0.2s;
}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:14px;
  background:linear-gradient(135deg,#6366f1,#8b5cf6);
  color:white;
  font-size:16px;
  font-weight:600;
  cursor:pointer;
  margin-top:10px;
}

button:disabled{opacity:0.5;cursor:not-allowed}

.share-row{
  display:flex;
  gap:8px;
  margin-top:10px;
}

.share-row button{
  flex:1;
  font-size:14px;
}

.yellow{background:#facc15;color:#000}
.blue{background:#38bdf8}
.red{background:#ef4444}
.gray{background:#94a3b8;color:#000}
.green{background:#22c55e}
</style>
</head>
<body>

<div class="container">

<h1>ğŸ¯ Lotto Generator</h1>

<div class="mode-toggle">
  <span>í•˜ë‚˜ì”©</span>
  <label class="switch">
    <input type="checkbox" id="modeSwitch">
    <span class="slider"></span>
  </label>
  <span>í•œë²ˆì—</span>
</div>

<div class="numbers" id="numbers"></div>

<button id="generateBtn" onclick="generate()">ğŸ° ë²ˆí˜¸ ë½‘ê¸°</button>

<div class="share-row" id="shareRow">
  <button onclick="copyNumbers()">ğŸ“‹ ë³µì‚¬</button>
  <button onclick="shareNumbers()">ğŸ“¤ ê³µìœ </button>
  <button onclick="saveImage()">ğŸ–¼ ì €ì¥</button>
</div>

</div>

<script>
const numbersContainer = document.getElementById("numbers");
const generateBtn = document.getElementById("generateBtn");
const shareRow = document.getElementById("shareRow");
const modeSwitch = document.getElementById("modeSwitch");

function getColorClass(num){
  if(num<=10) return "yellow";
  if(num<=20) return "blue";
  if(num<=30) return "red";
  if(num<=40) return "gray";
  return "green";
}

async function generate(){

  generateBtn.disabled=true;
  shareRow.style.display="none";
  numbersContainer.innerHTML="";

  const nums=new Set();
  while(nums.size<6){
    nums.add(Math.floor(Math.random()*45)+1);
  }
  const sorted=[...nums].sort((a,b)=>a-b);

  if(modeSwitch.checked){
    await allAtOnceMode(sorted);
  }else{
    await oneByOneMode(sorted);
  }

  generateBtn.disabled=false;
  shareRow.style.display="flex";
}

/* í•˜ë‚˜ì”© ë³´ê¸° */
async function oneByOneMode(finalNumbers){
  for(let i=0;i<6;i++){
    const ball=document.createElement("div");
    ball.className="ball";
    numbersContainer.appendChild(ball);

    await singleSlot(ball, finalNumbers[i]);
  }
}

function singleSlot(ball, finalNumber){
  return new Promise(resolve=>{
    let count=0;
    const interval=setInterval(()=>{
      const temp=Math.floor(Math.random()*45)+1;
      ball.textContent=temp;
      ball.className="ball "+getColorClass(temp);
      count++;
      if(count>20){
        clearInterval(interval);
        ball.textContent=finalNumber;
        ball.className="ball "+getColorClass(finalNumber);
        resolve();
      }
    },50);
  });
}

/* í•œë²ˆì— ë³´ê¸° (ë™ì¼ ì†ë„, ë¶€ë“œëŸ½ê²Œ) */
function allAtOnceMode(finalNumbers){
  return new Promise(resolve=>{
    const balls=[];
    for(let i=0;i<6;i++){
      const ball=document.createElement("div");
      ball.className="ball";
      numbersContainer.appendChild(ball);
      balls.push(ball);
    }

    let duration=2000;
    let start=null;

    function animate(timestamp){
      if(!start) start=timestamp;
      const progress=timestamp-start;

      if(progress<duration){

        balls.forEach(ball=>{
          const temp=Math.floor(Math.random()*45)+1;
          ball.textContent=temp;
          ball.className="ball "+getColorClass(temp);
        });

        requestAnimationFrame(animate);

      }else{

        balls.forEach((ball,index)=>{
          ball.textContent=finalNumbers[index];
          ball.className="ball "+getColorClass(finalNumbers[index]);
          ball.style.transform="scale(1.2)";
        });

        setTimeout(()=>{
          balls.forEach(ball=>ball.style.transform="scale(1)");
          resolve();
        },200);
      }
    }

    requestAnimationFrame(animate);
  });
}

/* ê³µìœ  */
function copyNumbers(){
  const nums=[...document.querySelectorAll(".ball")]
  .map(el=>el.textContent).join(", ");
  navigator.clipboard.writeText(nums);
  alert("ë²ˆí˜¸ ë³µì‚¬ ì™„ë£Œ âœ…");
}

function shareNumbers(){
  const nums=[...document.querySelectorAll(".ball")]
  .map(el=>el.textContent).join(", ");
  if(navigator.share){
    navigator.share({title:"ë¡œë˜ ë²ˆí˜¸",text:"ğŸ¯ "+nums});
  }else{
    alert("ê³µìœ  ê¸°ëŠ¥ ë¯¸ì§€ì›");
  }
}

function saveImage(){
  html2canvas(document.getElementById("numbers")).then(canvas=>{
    const link=document.createElement("a");
    link.download="lotto.png";
    link.href=canvas.toDataURL();
    link.click();
  });
}
</script>

</body>
</html>
